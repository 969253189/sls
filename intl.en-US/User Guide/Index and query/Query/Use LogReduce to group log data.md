# Use LogReduce to group log data {#concept_fkn_zwm_cgb .concept}

This topic describes how to use LogReduce to group collected log entries that are extremely similar to detect a frequently occurring log pattern.

## Scenario {#section_iwg_3sc_ghb .section}

With LogReduce, you can locate problems, detect exceptions, and perform other O&M actions for DevOps, or detect network intrusions hat may have compromised security. In addition, you can save the log grouping result as an analysis chart to a dashboard and then view the grouped data in real time.

## Advantages {#section_db1_2xm_cgb .section}

-   You can use the function to group log entries of in the format of Log4J, JSON, or Syslog, and which are filtered by any conditions.
-   Hundreds of millions of data can be grouped in seconds.
-   You can view the raw log entries of the grouped log entries of each log pattern, and display the number of grouped log entries in different time ranges.
-   You can dynamically adjust the precision of log grouping.

## Index size {#section_isn_mbn_cgb .section}

**Note:** After you enable the LogReduce function, the size of log indexes increases by 10% compared with the size of the raw logs. For example, if the size of raw log data is 100 GB/day, the size of the log indexes will increase by 10 GB after you enable the function.

|Raw log size|Proportion of indexes in the raw log|Size of indexes generated by LogReduce|Index size|
|:-----------|:-----------------------------------|:-------------------------------------|:---------|
|100 GB|20% \(20 GB\)|100 \* 10%|30 GB|
|100 GB|40% \(40 GB\)|100 \* 10%|50 GB|
|100 GB|100% \(100 GB\)|100 \* 10%|110 GB|

## Enable LogReduce {#section_pvh_g1n_cgb .section}

**Note:** By default, the function is disabled.

1.  Log on to the [Log Service console](https://partners-intl.console.aliyun.com/#/sls) and click the project name.
2.  On the Logstores page, click **Search** on the right of the target Logstore.
3.  If you have enabled the index function, choose **Index Attributes** \> **Modify**. If you have not enabled the index function, click **Enable**.

    ![](images/12614_en-US.png "Enable the index function")

    ![](images/42060_en-US.png "Modify the log index")

4.  Set index parameters, and click the switch to enable the LogReduce function.

    ![](images/34193_en-US.png "Enable LogReduce")

5.  Click **OK**.

    **Note:** After you enable the LogReduce function, Log Service automatically groups collected log data.

    The, you can perform the following operations:

    -   [View the log grouping result and the raw log](#).
    -   [Adjust the log grouping precision](#).
    -   [Show the number of grouped log entries in different periods](#).

## View the log grouping result and the raw log {#section_h2w_g1n_cgb .section}

1.  On the Search & Analysis page, enter a search and analysis statement in the search box, and click **Search & Analysis**.

    **Note:** 

    -   You can also use key words to filter the grouped log entries.
    -   The SQL type of statements is not supported by the LogReduce function. This means that analysis results of log data cannot be grouped by this function.
2.  Click the **LogReduce** tab to view the result.

    |Item|Description|
    |:---|:----------|
    |**Number**|Indicates the sequence number of a log group.|
    |**Count**|Indicates the number of log entries of a log group.|
    |**Pattern**|Indicates the log patterns. Each log group has one or multiple sub-patterns.|

    ![](images/42061_en-US.png "Result")

3.  Move your pointer over a **Count** value to show the sub-patterns of this log group and the proportion of each sub-pattern in the log group.

    **Note:** You can also click **+** in front of a **Count** value to show the pattern list of the log group.

    ![](images/34195_en-US.png "View log grouping details")

4.  Click a **Count** value to view the raw log of the log group.

    ![](images/34218_en-US.png "View the raw log")


## Adjust the log grouping precision {#section_ol3_t1n_cgb .section}

1.  On the Search & Analysis page, click the **LogReduce** tab.
2.  In the upper-right corner of the tab page, drag the **Pattern** slider to adjust the log grouping precision.

    -   If you drag the slider towards **Max**, the system outputs a more specific log grouping result and shows patterns in greater detail.
    -   If you drag the slider towards **Min**, the system outputs a less specific log grouping result and shows patterns in less detail.

![](images/34196_en-US.png "Adjust the log grouping precision")

## Show the number of grouped log entries in different time ranges {#section_r4b_v1n_cgb .section}

On the Search & Analysis page, enter the following search and analysis statement in the search box, and click **Search & Analysis**:

```
*  | select 
                v.signature,  
                v.pattern, 
                coalesce(v.cmp[1],0) as count_now, 
                coalesce(v.cmp[2],0) as count_before, 
                coalesce(v.cmp[1],0) - coalesce(v.cmp[2],0) as count_diff 
                    from (
                        select 
                            p.signature as signature ,
                            arbitrary(p.pattern) as pattern , 
                            compare(p.count,300) as cmp 
                            from 
                                (select log_reduce() as p from log) group by p.signature
                        )v  order by count_diff desc
```

The result shows the following information.

|Item|Description|
|:---|:----------|
|**signature**|Identifies the log pattern.|
|**pattern**|Shows the detailed log patterns of the log group.|
|**count\_now**|Indicates the number of the raw log entries for the log pattern in the current time range. The time range is specified in the SQL statement.|
|**count\_before**|Indicates the number of the raw log entries for the log pattern in a prior time range. The prior time range is specified in the SQL statement.|
|**count\_diff**|Indicates the difference between the number of log entries of this pattern in the current time range and the number of log entries of this pattern in the prior time range.|

![](images/34223_en-US.png "Show the number of grouped log entries in different time ranges")

